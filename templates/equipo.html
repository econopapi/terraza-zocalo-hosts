{% extends "base.html" %}

{% block title %}Equipo {{ equipo.id_equipo }} - {{ equipo.lider_equipo }}{% endblock %}

{% block content %}
<div class="header">
    <h1>Equipo {{ equipo.id_equipo }}</h1>
    <p>Líder: {{ equipo.lider_equipo }}</p>
    <!--<a href="{{ url_for('reporte_equipo', equipo_id=equipo.id_equipo) }}" style="color: #4CAF50;">Ver Reporte del Día</a>-->
</div>

<div class="form-card">
    <h2>Registrar Hosteo</h2>
    <form method="POST">
        <div class="form-group">
            <label>Equipo</label>
            <input type="text" value="Equipo {{ equipo.id_equipo }}" disabled>
        </div>
        
        <div class="form-group">
            <label>Host *</label>
            {% if locked_host %}
                <select name="id_host" disabled>
                    <option value="{{ locked_host.id_host }}">{{ locked_host.nombre_host }}</option>
                </select>
                <!-- hidden to ensure submission -->
                <input type="hidden" name="id_host" value="{{ locked_host.id_host }}">
            {% else %}
                <select name="id_host" required>
                    <option value="">Selecciona un host</option>
                    {% for host in hosts %}
                    <option value="{{ host.id_host }}">{{ host.nombre_host }}</option>
                    {% endfor %}
                </select>
            {% endif %}
        </div>
        
        <div class="form-group">
            <label>Número de Personas *</label>
            <input type="number" name="numero_personas" min="1" required>
        </div>
        
        <div class="form-group">
            <label>Mesero Asignado *</label>
            <select name="id_mesero" required>
                <option value="">Selecciona un mesero</option>
                {% for mesero in meseros %}
                <option value="{{ mesero.id_mesero }}">{{ mesero.nombre_mesero }}</option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit">Registrar Hosteo</button>
    </form>
</div>

<div class="form-card">
    <h2>Registros de Hoy</h2>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Hora</th>
                    <th>Host</th>
                    <th>Personas</th>
                    <th>Mesero</th>
                    <th>Confirmado</th>
                </tr>
            </thead>
            <tbody>
                {% for registro in registros %}
                <tr>
                    <td>{{ registro.hora.strftime('%H:%M') }}</td>
                    <td>{{ registro.host.nombre_host if registro.host else 'N/D' }}</td>
                    <td>{{ registro.numero_personas }}</td>
                    <td>{{ registro.mesero.nombre_mesero if registro.mesero else 'N/D' }}</td>
                    <td>
                        <!-- Hosts no pueden confirmar aquí: sólo mostrar estado -->
                        <span class="{% if registro.confirmada %}confirmada{% else %}no-confirmada{% endif %}">
                            {% if registro.confirmada %}✅{% else %}❌{% endif %}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}{% endblock %}